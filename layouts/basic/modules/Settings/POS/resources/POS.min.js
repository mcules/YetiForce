
jQuery.Class("Settings_POS_Index_Js",{},{registerTableEvents:function(){var b=this;var a=$(".configContainer");a.find(".edit").on("click",function(f){var d=$(f.currentTarget);var c=d.closest("tr");b.showFormToEditKey(c.data("id"))});a.find(".remove").on("click",function(g){var f=jQuery(g.currentTarget);var c=f.closest("tr");var d=app.vtranslate("JS_DELETE_CONFIRMATION");Vtiger_Helper_Js.showConfirmationBox({message:d}).then(function(i){var j={module:app.getModuleName(),parent:app.getParentModuleName(),action:"Delete",id:c.data("id")};var h=jQuery.progressIndicator();AppConnector.request(j).then(function(e){h.progressIndicator({mode:"hide"});b.loadTable()})},function(e,h){})})},loadTable:function(){var b=this;var c={module:app.getModuleName(),parent:app.getParentModuleName(),view:"Index",};var a=jQuery.progressIndicator();AppConnector.request(c).then(function(d){a.progressIndicator({mode:"hide"});$(".configContainer").html(d);b.registerTableEvents()})},showFormToEditKey:function(d){var b=this;var c={module:app.getModuleName(),parent:app.getParentModuleName(),view:"CreateKey",};if(d!=""){c.record=d}var a=jQuery.progressIndicator();AppConnector.request(c).then(function(e){a.progressIndicator({mode:"hide"});app.showModalWindow(e,function(f){f.find('[name="saveButton"]').on("click",function(){var g={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",user:f.find(".users").val(),actionPos:f.find(".actionPos").val(),server:f.find(".server").val(),status:f.find('[name="status"]').is(":checked"),userName:f.find('[name="userName"]').val(),firstName:f.find('[name="firstName"]').val(),lastName:f.find('[name="lastName"]').val(),email:f.find('[name="email"]').val(),pass:f.find('[name="pass"]').val(),};if(d!=""){g.id=d}AppConnector.request(g).then(function(h){if(h.result.success){b.loadTable();app.hideModalWindow()}else{var i={title:app.vtranslate("JS_LBL_PERMISSION"),text:app.vtranslate(h.result.error),type:"error",animation:"show"};Vtiger_Helper_Js.showMessage(i)}})})})})},registerAddButton:function(){var a=this;$(".createKey").on("click",function(){a.showFormToEditKey()})},registerEvents:function(){this.registerAddButton();this.registerTableEvents()}});